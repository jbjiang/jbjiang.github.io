<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Q命令在csv和tsv上使用sql语句 | Thinkml&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="q allows performing SQL-like statements on tabular text data. Its purpose is to bring SQL expressive power to the Linux command line and to provide easy access to text as actual data.Query should be a">
<meta property="og:type" content="article">
<meta property="og:title" content="Q命令在csv和tsv上使用sql语句">
<meta property="og:url" content="http://needpp.com/2015/04/22/Q命令在csv和tsv上使用sql语句/index.html">
<meta property="og:site_name" content="Thinkml's blog">
<meta property="og:description" content="q allows performing SQL-like statements on tabular text data. Its purpose is to bring SQL expressive power to the Linux command line and to provide easy access to text as actual data.Query should be a">
<meta property="og:updated_time" content="2015-12-15T14:44:57.998Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Q命令在csv和tsv上使用sql语句">
<meta name="twitter:description" content="q allows performing SQL-like statements on tabular text data. Its purpose is to bring SQL expressive power to the Linux command line and to provide easy access to text as actual data.Query should be a">
  
    <link rel="alternative" href="/atom.xml" title="Thinkml&#39;s blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/logo.jpg">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="/img/logo.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">thinkml</a></h1>
		</hgroup>

		
		<p class="header-subtitle">happy wife, happy life...</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
							<li><a href="/tags/life">随笔</a></li>
				        
							<li><a href="/about">关于</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/dcycome" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/SupreDream" title="weibo">weibo</a>
					        
								<a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/2014/" style="font-size: 10px;">2014</a> <a href="/tags/2015/" style="font-size: 10px;">2015</a> <a href="/tags/R/" style="font-size: 10px;">R</a> <a href="/tags/about/" style="font-size: 10px;">about</a> <a href="/tags/android/" style="font-size: 10px;">android</a> <a href="/tags/blog/" style="font-size: 10px;">blog</a> <a href="/tags/boost/" style="font-size: 10px;">boost</a> <a href="/tags/car/" style="font-size: 10px;">car</a> <a href="/tags/coding/" style="font-size: 10px;">coding</a> <a href="/tags/command/" style="font-size: 10px;">command</a> <a href="/tags/d3/" style="font-size: 10px;">d3</a> <a href="/tags/dm/" style="font-size: 10px;">dm</a> <a href="/tags/flask/" style="font-size: 10px;">flask</a> <a href="/tags/friend/" style="font-size: 10px;">friend</a> <a href="/tags/gbrt/" style="font-size: 10px;">gbrt</a> <a href="/tags/git/" style="font-size: 12px;">git</a> <a href="/tags/github/" style="font-size: 10px;">github</a> <a href="/tags/gps/" style="font-size: 10px;">gps</a> <a href="/tags/hadoop/" style="font-size: 14px;">hadoop</a> <a href="/tags/hbase/" style="font-size: 12px;">hbase</a> <a href="/tags/hive/" style="font-size: 12px;">hive</a> <a href="/tags/ijcai/" style="font-size: 10px;">ijcai</a> <a href="/tags/ip/" style="font-size: 10px;">ip</a> <a href="/tags/life/" style="font-size: 18px;">life</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/markdown/" style="font-size: 10px;">markdown</a> <a href="/tags/maven/" style="font-size: 14px;">maven</a> <a href="/tags/me/" style="font-size: 12px;">me</a> <a href="/tags/ml/" style="font-size: 20px;">ml</a> <a href="/tags/model/" style="font-size: 10px;">model</a> <a href="/tags/myblog/" style="font-size: 10px;">myblog</a> <a href="/tags/mysql/" style="font-size: 12px;">mysql</a> <a href="/tags/nginx/" style="font-size: 10px;">nginx</a> <a href="/tags/nosql/" style="font-size: 10px;">nosql</a> <a href="/tags/oauth/" style="font-size: 10px;">oauth</a> <a href="/tags/opencv/" style="font-size: 10px;">opencv</a> <a href="/tags/os/" style="font-size: 10px;">os</a> <a href="/tags/others/" style="font-size: 12px;">others</a> <a href="/tags/pandas/" style="font-size: 10px;">pandas</a> <a href="/tags/phoenix/" style="font-size: 12px;">phoenix</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/q/" style="font-size: 10px;">q</a> <a href="/tags/share/" style="font-size: 12px;">share</a> <a href="/tags/shell/" style="font-size: 10px;">shell</a> <a href="/tags/spark/" style="font-size: 14px;">spark</a> <a href="/tags/spss/" style="font-size: 10px;">spss</a> <a href="/tags/ss/" style="font-size: 10px;">ss</a> <a href="/tags/temp/" style="font-size: 10px;">temp</a> <a href="/tags/tmall/" style="font-size: 10px;">tmall</a> <a href="/tags/tools/" style="font-size: 20px;">tools</a> <a href="/tags/ubuntu/" style="font-size: 16px;">ubuntu</a> <a href="/tags/weka/" style="font-size: 16px;">weka</a> <a href="/tags/win/" style="font-size: 10px;">win</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://me.needpp.com">thinkml&#39;s blog</a>
			        
			        </div>
				</section>
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">thinkml</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="/img/logo.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">thinkml</h1>
			</hgroup>
			
			<p class="header-subtitle">happy wife, happy life...</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
					<li><a href="/tags/life">随笔</a></li>
		        
					<li><a href="/about">关于</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/dcycome" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/SupreDream" title="weibo">weibo</a>
			        
						<a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-Q命令在csv和tsv上使用sql语句" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/04/22/Q命令在csv和tsv上使用sql语句/" class="article-date">
  	<time datetime="2015-04-21T16:00:00.000Z" itemprop="datePublished">2015-04-22</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Q命令在csv和tsv上使用sql语句
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/q/">q</a></li></ul>
	</div>

        

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">q allows performing SQL-like statements on tabular text data. Its purpose is to bring SQL expressive power to the Linux command line and to provide easy access to text as actual data.</span><br><span class="line"></span><br><span class="line">Query should be an SQL-like query which contains filenames instead of table names (or - for stdin). The query itself should be provided as one parameter to the tool (i.e. enclosed in quotes).</span><br><span class="line"></span><br><span class="line"><span class="operator"><span class="keyword">Use</span> -H <span class="keyword">to</span> signify that the <span class="keyword">input</span> contains a header line. <span class="keyword">Column</span> <span class="keyword">names</span> will be detected automatically <span class="keyword">in</span> that <span class="keyword">case</span>, <span class="keyword">and</span> can be used <span class="keyword">in</span> the <span class="keyword">query</span>. <span class="keyword">If</span> this <span class="keyword">option</span> <span class="keyword">is</span> <span class="keyword">not</span> provided, <span class="keyword">columns</span> will be named cX, <span class="keyword">starting</span> <span class="keyword">with</span> <span class="number">1</span> (<span class="keyword">e</span>.<span class="keyword">g</span>. q <span class="string">"SELECT c3,c8 from ..."</span>).</span><br><span class="line"></span><br><span class="line"><span class="keyword">Use</span> -<span class="keyword">d</span> <span class="keyword">to</span> specify the <span class="keyword">input</span> delimiter.</span><br><span class="line"></span><br><span class="line"><span class="keyword">Column</span> types <span class="keyword">are</span> <span class="keyword">auto</span> detected <span class="keyword">by</span> the tool, <span class="keyword">no</span> casting <span class="keyword">is</span> needed.</span><br><span class="line"></span><br><span class="line">Please note that <span class="keyword">column</span> <span class="keyword">names</span> that <span class="keyword">include</span> spaces need <span class="keyword">to</span> be used <span class="keyword">in</span> the <span class="keyword">query</span> <span class="keyword">with</span> back-ticks, <span class="keyword">as</span> per the sqlite standard.</span><br><span class="line"></span><br><span class="line"><span class="keyword">Query</span>/<span class="keyword">Input</span>/<span class="keyword">Output</span> encodings <span class="keyword">are</span> fully supported (<span class="keyword">and</span> q tries <span class="keyword">to</span> provide <span class="keyword">out</span>-<span class="keyword">of</span>-the-box usability <span class="keyword">in</span> that area). Please <span class="keyword">use</span> -<span class="keyword">e</span>,-<span class="keyword">E</span> <span class="keyword">and</span> -Q <span class="keyword">to</span> control <span class="keyword">encoding</span> <span class="keyword">if</span> needed.</span><br><span class="line"></span><br><span class="line">All sqlite3 <span class="keyword">SQL</span> constructs <span class="keyword">are</span> supported, <span class="keyword">including</span> joins across files (<span class="keyword">use</span> an <span class="keyword">alias</span> <span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">table</span>).</span><br><span class="line">See https://github.com/harelba/q <span class="keyword">for</span> more details.</span><br><span class="line"></span><br><span class="line">&lt;!<span class="comment">--more--&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>i.csv 文件<br><figure class="highlight autohotkey"><table><tr><td class="code"><pre><span class="line">item_id,item_geohash,item_category</span><br><span class="line"><span class="number">312051294</span>,,<span class="number">8270</span></span><br><span class="line"><span class="number">99999754</span>,,<span class="number">7393</span></span><br><span class="line"><span class="number">131746128</span>,,<span class="number">7876</span></span><br><span class="line"><span class="number">385731330</span>,,<span class="number">10544</span></span><br><span class="line"><span class="number">100004415</span>,,<span class="number">3064</span></span><br><span class="line"><span class="number">76588345</span>,<span class="number">95</span>qqvei,<span class="number">5411</span></span><br><span class="line"><span class="number">312053799</span>,,<span class="number">13547</span></span><br><span class="line"><span class="number">100004955</span>,,<span class="number">7033</span></span><br><span class="line"><span class="number">312322681</span>,,<span class="number">8376</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight autohotkey"><table><tr><td class="code"><pre><span class="line">cat i.csv | q -H -d ',' <span class="string">"select * from -"</span></span><br><span class="line"></span><br><span class="line"><span class="number">312051294</span>,,<span class="number">8270</span></span><br><span class="line"><span class="number">99999754</span>,,<span class="number">7393</span></span><br><span class="line"><span class="number">131746128</span>,,<span class="number">7876</span></span><br><span class="line"><span class="number">385731330</span>,,<span class="number">10544</span></span><br><span class="line"><span class="number">100004415</span>,,<span class="number">3064</span></span><br><span class="line"><span class="number">76588345</span>,<span class="number">95</span>qqvei,<span class="number">5411</span></span><br><span class="line"><span class="number">312053799</span>,,<span class="number">13547</span></span><br><span class="line"><span class="number">100004955</span>,,<span class="number">7033</span></span><br><span class="line"><span class="number">312322681</span>,,<span class="number">8376</span></span><br></pre></td></tr></table></figure>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2015/04/27/pandas数据操作/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          pandas数据操作
        
      </div>
    </a>
  
  
    <a href="/2015/04/08/spark car/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">spark car</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>




<div class="duoshuo">
	<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="Q命令在csv和tsv上使用sql语句" data-title="Q命令在csv和tsv上使用sql语句" data-url="http://needpp.com/2015/04/22/Q命令在csv和tsv上使用sql语句/"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"needpp"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- 多说公共JS代码 end -->
</div>




</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2015 thinkml
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>



<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-56213181-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->




<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>